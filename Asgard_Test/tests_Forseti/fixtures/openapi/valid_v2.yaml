swagger: "2.0"
info:
  title: User Management API
  description: A Swagger 2.0 API specification for user management
  version: "1.0.0"
  contact:
    name: API Support
    email: support@example.com
    url: https://example.com/support
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html
  termsOfService: https://example.com/terms

host: api.example.com
basePath: /v1
schemes:
  - https
  - http

consumes:
  - application/json
produces:
  - application/json

securityDefinitions:
  apiKey:
    type: apiKey
    name: X-API-Key
    in: header
  basicAuth:
    type: basic

security:
  - apiKey: []

tags:
  - name: users
    description: User management operations
  - name: admin
    description: Administrative operations

paths:
  /users:
    get:
      tags:
        - users
      summary: List all users
      description: Returns a paginated list of users
      operationId: listUsers
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          required: false
          type: integer
          default: 1
          minimum: 1
        - name: limit
          in: query
          description: Number of items per page
          required: false
          type: integer
          default: 20
          minimum: 1
          maximum: 100
        - name: sort
          in: query
          description: Sort field
          required: false
          type: string
          enum:
            - created_at
            - updated_at
            - name
            - email
      responses:
        200:
          description: Successful response
          schema:
            type: object
            properties:
              data:
                type: array
                items:
                  $ref: "#/definitions/User"
              pagination:
                $ref: "#/definitions/Pagination"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/Error"
        500:
          description: Internal server error
          schema:
            $ref: "#/definitions/Error"

    post:
      tags:
        - users
      summary: Create a new user
      description: Creates a new user account
      operationId: createUser
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: "#/definitions/CreateUserRequest"
      responses:
        201:
          description: User created successfully
          schema:
            $ref: "#/definitions/User"
        400:
          description: Invalid input
          schema:
            $ref: "#/definitions/Error"
        409:
          description: User already exists
          schema:
            $ref: "#/definitions/Error"

  /users/{userId}:
    get:
      tags:
        - users
      summary: Get user by ID
      description: Returns a single user
      operationId: getUserById
      parameters:
        - name: userId
          in: path
          description: User ID
          required: true
          type: string
          format: uuid
      responses:
        200:
          description: Successful response
          schema:
            $ref: "#/definitions/User"
        404:
          description: User not found
          schema:
            $ref: "#/definitions/Error"

    put:
      tags:
        - users
      summary: Update user
      description: Updates an existing user
      operationId: updateUser
      parameters:
        - name: userId
          in: path
          required: true
          type: string
          format: uuid
        - name: body
          in: body
          required: true
          schema:
            $ref: "#/definitions/UpdateUserRequest"
      responses:
        200:
          description: User updated successfully
          schema:
            $ref: "#/definitions/User"
        400:
          description: Invalid input
          schema:
            $ref: "#/definitions/Error"
        404:
          description: User not found
          schema:
            $ref: "#/definitions/Error"

    delete:
      tags:
        - users
        - admin
      summary: Delete user
      description: Deletes a user account
      operationId: deleteUser
      security:
        - basicAuth: []
      parameters:
        - name: userId
          in: path
          required: true
          type: string
          format: uuid
      responses:
        204:
          description: User deleted successfully
        404:
          description: User not found
          schema:
            $ref: "#/definitions/Error"

  /users/{userId}/profile:
    get:
      tags:
        - users
      summary: Get user profile
      operationId: getUserProfile
      parameters:
        - name: userId
          in: path
          required: true
          type: string
          format: uuid
      responses:
        200:
          description: Successful response
          schema:
            $ref: "#/definitions/UserProfile"

definitions:
  User:
    type: object
    required:
      - id
      - email
      - name
    properties:
      id:
        type: string
        format: uuid
        description: Unique user identifier
      email:
        type: string
        format: email
        description: User email address
      name:
        type: string
        minLength: 1
        maxLength: 100
        description: User full name
      role:
        type: string
        enum:
          - user
          - admin
          - moderator
        default: user
      status:
        type: string
        enum:
          - active
          - inactive
          - pending
        default: pending
      created_at:
        type: string
        format: date-time
      updated_at:
        type: string
        format: date-time

  CreateUserRequest:
    type: object
    required:
      - email
      - name
      - password
    properties:
      email:
        type: string
        format: email
      name:
        type: string
        minLength: 1
        maxLength: 100
      password:
        type: string
        format: password
        minLength: 8
        maxLength: 128
      role:
        type: string
        enum:
          - user
          - admin
          - moderator

  UpdateUserRequest:
    type: object
    properties:
      name:
        type: string
        minLength: 1
        maxLength: 100
      role:
        type: string
        enum:
          - user
          - admin
          - moderator
      status:
        type: string
        enum:
          - active
          - inactive
          - pending

  UserProfile:
    type: object
    properties:
      user_id:
        type: string
        format: uuid
      bio:
        type: string
        maxLength: 500
      avatar_url:
        type: string
        format: uri
      location:
        type: string
      website:
        type: string
        format: uri
      social_links:
        type: object
        additionalProperties:
          type: string

  Pagination:
    type: object
    properties:
      page:
        type: integer
      limit:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer

  Error:
    type: object
    required:
      - code
      - message
    properties:
      code:
        type: string
      message:
        type: string
      details:
        type: array
        items:
          type: object
          properties:
            field:
              type: string
            error:
              type: string
