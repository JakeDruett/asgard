openapi: 3.0.3
info:
  title: Petstore API
  description: |
    Standard Petstore API for testing OpenAPI tools.
    This is a comprehensive example that covers most OpenAPI features.
  version: 1.0.0
  contact:
    name: Petstore Support
    email: support@petstore.example.com
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html

servers:
  - url: https://petstore.example.com/api/v1
    description: Production server
  - url: https://staging.petstore.example.com/api/v1
    description: Staging server

tags:
  - name: pets
    description: Pet operations
  - name: store
    description: Store operations
  - name: users
    description: User operations

security:
  - petstore_auth:
      - read:pets
      - write:pets

paths:
  /pets:
    get:
      tags:
        - pets
      summary: List all pets
      operationId: listPets
      parameters:
        - name: limit
          in: query
          description: Maximum number of pets to return
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: offset
          in: query
          description: Number of pets to skip
          schema:
            type: integer
            minimum: 0
            default: 0
        - name: species
          in: query
          description: Filter by species
          schema:
            type: string
            enum:
              - dog
              - cat
              - bird
              - fish
              - reptile
              - other
        - name: status
          in: query
          description: Filter by availability status
          schema:
            type: string
            enum:
              - available
              - pending
              - sold
      responses:
        "200":
          description: Successful response
          headers:
            X-Total-Count:
              description: Total number of pets
              schema:
                type: integer
            X-RateLimit-Remaining:
              description: Remaining API calls
              schema:
                type: integer
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Pet"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"

    post:
      tags:
        - pets
      summary: Add a new pet
      operationId: addPet
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/NewPet"
          multipart/form-data:
            schema:
              type: object
              properties:
                name:
                  type: string
                species:
                  type: string
                photo:
                  type: string
                  format: binary
      responses:
        "201":
          description: Pet created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Pet"
        "400":
          $ref: "#/components/responses/BadRequest"
        "409":
          description: Pet already exists
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /pets/{petId}:
    parameters:
      - $ref: "#/components/parameters/PetId"
    get:
      tags:
        - pets
      summary: Get pet by ID
      operationId: getPetById
      responses:
        "200":
          description: Pet details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Pet"
        "404":
          $ref: "#/components/responses/NotFound"

    put:
      tags:
        - pets
      summary: Update pet
      operationId: updatePet
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdatePet"
      responses:
        "200":
          description: Pet updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Pet"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

    delete:
      tags:
        - pets
      summary: Delete pet
      operationId: deletePet
      security:
        - petstore_auth:
            - write:pets
      responses:
        "204":
          description: Pet deleted
        "404":
          $ref: "#/components/responses/NotFound"

  /pets/{petId}/photos:
    parameters:
      - $ref: "#/components/parameters/PetId"
    get:
      tags:
        - pets
      summary: Get pet photos
      operationId: getPetPhotos
      responses:
        "200":
          description: Photo list
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Photo"

    post:
      tags:
        - pets
      summary: Upload pet photo
      operationId: uploadPetPhoto
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                caption:
                  type: string
                  maxLength: 200
      responses:
        "201":
          description: Photo uploaded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Photo"

  /pets/findByStatus:
    get:
      tags:
        - pets
      summary: Find pets by status
      operationId: findPetsByStatus
      parameters:
        - name: status
          in: query
          required: true
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
              enum:
                - available
                - pending
                - sold
      responses:
        "200":
          description: Pets found
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Pet"

  /pets/findByTags:
    get:
      tags:
        - pets
      summary: Find pets by tags
      operationId: findPetsByTags
      deprecated: true
      parameters:
        - name: tags
          in: query
          required: true
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
      responses:
        "200":
          description: Pets found
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Pet"

  /store/inventory:
    get:
      tags:
        - store
      summary: Get inventory
      operationId: getInventory
      security:
        - api_key: []
      responses:
        "200":
          description: Inventory counts by status
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: integer

  /store/orders:
    post:
      tags:
        - store
      summary: Place order
      operationId: placeOrder
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Order"
      responses:
        "201":
          description: Order placed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Order"
        "400":
          $ref: "#/components/responses/BadRequest"

  /store/orders/{orderId}:
    parameters:
      - name: orderId
        in: path
        required: true
        schema:
          type: integer
          format: int64
    get:
      tags:
        - store
      summary: Get order by ID
      operationId: getOrderById
      responses:
        "200":
          description: Order details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Order"
        "404":
          $ref: "#/components/responses/NotFound"

    delete:
      tags:
        - store
      summary: Cancel order
      operationId: deleteOrder
      responses:
        "204":
          description: Order cancelled
        "404":
          $ref: "#/components/responses/NotFound"

  /users:
    post:
      tags:
        - users
      summary: Create user
      operationId: createUser
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/User"
      responses:
        "201":
          description: User created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"

  /users/login:
    get:
      tags:
        - users
      summary: Log in user
      operationId: loginUser
      security: []
      parameters:
        - name: username
          in: query
          required: true
          schema:
            type: string
        - name: password
          in: query
          required: true
          schema:
            type: string
            format: password
      responses:
        "200":
          description: Login successful
          headers:
            X-Expires-After:
              description: Session expiration
              schema:
                type: string
                format: date-time
            X-Rate-Limit:
              description: Rate limit
              schema:
                type: integer
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                  expires_at:
                    type: string
                    format: date-time
        "400":
          description: Invalid credentials

  /users/logout:
    get:
      tags:
        - users
      summary: Log out user
      operationId: logoutUser
      responses:
        "200":
          description: Logout successful

  /users/{username}:
    parameters:
      - name: username
        in: path
        required: true
        schema:
          type: string
    get:
      tags:
        - users
      summary: Get user by username
      operationId: getUserByName
      responses:
        "200":
          description: User details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "404":
          $ref: "#/components/responses/NotFound"

    put:
      tags:
        - users
      summary: Update user
      operationId: updateUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/User"
      responses:
        "200":
          description: User updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"

    delete:
      tags:
        - users
      summary: Delete user
      operationId: deleteUser
      responses:
        "204":
          description: User deleted
        "404":
          $ref: "#/components/responses/NotFound"

components:
  securitySchemes:
    petstore_auth:
      type: oauth2
      flows:
        implicit:
          authorizationUrl: https://petstore.example.com/oauth/authorize
          scopes:
            read:pets: Read pets
            write:pets: Modify pets
    api_key:
      type: apiKey
      name: api_key
      in: header

  parameters:
    PetId:
      name: petId
      in: path
      required: true
      description: Pet ID
      schema:
        type: integer
        format: int64

  schemas:
    Pet:
      type: object
      required:
        - id
        - name
        - species
      properties:
        id:
          type: integer
          format: int64
          readOnly: true
        name:
          type: string
          minLength: 1
          maxLength: 100
        species:
          type: string
          enum:
            - dog
            - cat
            - bird
            - fish
            - reptile
            - other
        breed:
          type: string
          maxLength: 50
        age:
          type: integer
          minimum: 0
          maximum: 100
        weight:
          type: number
          format: float
          minimum: 0
        color:
          type: string
        tags:
          type: array
          items:
            $ref: "#/components/schemas/Tag"
        status:
          type: string
          enum:
            - available
            - pending
            - sold
          default: available
        photos:
          type: array
          items:
            $ref: "#/components/schemas/Photo"
        category:
          $ref: "#/components/schemas/Category"
        created_at:
          type: string
          format: date-time
          readOnly: true
        updated_at:
          type: string
          format: date-time
          readOnly: true

    NewPet:
      type: object
      required:
        - name
        - species
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 100
        species:
          type: string
          enum:
            - dog
            - cat
            - bird
            - fish
            - reptile
            - other
        breed:
          type: string
        age:
          type: integer
          minimum: 0
        weight:
          type: number
          format: float
          minimum: 0
        color:
          type: string
        tags:
          type: array
          items:
            type: string
        category_id:
          type: integer
          format: int64

    UpdatePet:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 100
        breed:
          type: string
        age:
          type: integer
          minimum: 0
        weight:
          type: number
          format: float
          minimum: 0
        color:
          type: string
        status:
          type: string
          enum:
            - available
            - pending
            - sold
        tags:
          type: array
          items:
            type: string

    Category:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string

    Tag:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string

    Photo:
      type: object
      properties:
        id:
          type: integer
          format: int64
        url:
          type: string
          format: uri
        thumbnail_url:
          type: string
          format: uri
        caption:
          type: string
        uploaded_at:
          type: string
          format: date-time

    Order:
      type: object
      properties:
        id:
          type: integer
          format: int64
          readOnly: true
        pet_id:
          type: integer
          format: int64
        quantity:
          type: integer
          minimum: 1
          default: 1
        ship_date:
          type: string
          format: date-time
        status:
          type: string
          enum:
            - placed
            - approved
            - delivered
        complete:
          type: boolean
          default: false

    User:
      type: object
      properties:
        id:
          type: integer
          format: int64
          readOnly: true
        username:
          type: string
          minLength: 3
          maxLength: 50
          pattern: "^[a-zA-Z0-9_]+$"
        first_name:
          type: string
        last_name:
          type: string
        email:
          type: string
          format: email
        password:
          type: string
          format: password
          writeOnly: true
          minLength: 8
        phone:
          type: string
        status:
          type: integer
          description: User status (0=inactive, 1=active)

    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: integer
        message:
          type: string
        details:
          type: string

  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
